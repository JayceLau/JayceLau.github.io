<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="google-site-verification" content="" />
  
  <title>Oracle RAC 12cR2安装手册(2)--环境的准备</title>
  <meta name="author" content="Jayce">
   <meta name="description" content="配置操作系统
安装依赖包
配置内核参数
关闭NTP
配置PAM
关闭SELinux
创建用户、组、文件夹
配置环境变量
配置grid用户的环境变量
配置oracle的环境变量




配置网络
配置hosts解析
关闭虚拟网卡
禁用ZEROCONF


配置SSH互信
配置存储
安装ASMLIB
创">
  

  <meta property="og:title" content="Oracle RAC 12cR2安装手册(2)--环境的准备"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:site_name" content="JR4ever"/>
 <meta property="og:image" content="undefined"/>
  
  <link href="/apple-touch-icon-precomposed.png" sizes="180x180" rel="apple-touch-icon-precomposed">
  <link rel="alternate" href="/atom.xml" title="JR4ever" type="application/atom+xml">
  <link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="/css/m.min.css">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
</head>

<body>
  <a id="top"></a>
  <div id='wx_pic' style='display:none;'><img src='/wx_share.png'/></div>
  <div id="main">
    <div class="behind">
      <div class="back">
        <a href="/" class="black-color"><i class="fa fa-times" aria-hidden="true"></i></a>
      </div>
      <div class="description">
        &nbsp;JR4ever
      </div>
    </div>
    <div class="container">
      

  <article class="standard post">
    <div class="title">
      
  
    <h1 class="page-title center">
        Oracle RAC 12cR2安装手册(2)--环境的准备
    </h1>
  


    </div>
    <div class="meta center">
      
<time datetime="2017-06-29T02:23:01.000Z">
  <i class="fa fa-calendar"></i>&nbsp;
  2017-06-29
</time>



    
    &nbsp;
    <i class="fa fa-tag"></i>&nbsp;
    <a href="/categories/Oracle/">Oracle</a>·<a href="/categories/Oracle/RAC/">RAC</a>




    
    &nbsp;
    <i class="fa fa-tag"></i>&nbsp;
    <a href="/tags/Tech/">Tech</a>·<a href="/tags/Installation/">Installation</a>


    </div>
    <hr>
    <div class="picture-container">
      
    </div>
    <!-- toc -->
<ul>
<li><a href="#配置操作系统">配置操作系统</a><ul>
<li><a href="#安装依赖包">安装依赖包</a></li>
<li><a href="#配置内核参数">配置内核参数</a></li>
<li><a href="#关闭ntp">关闭NTP</a></li>
<li><a href="#配置pam">配置PAM</a></li>
<li><a href="#关闭selinux">关闭SELinux</a></li>
<li><a href="#创建用户-组-文件夹">创建用户、组、文件夹</a></li>
<li><a href="#配置环境变量">配置环境变量</a><ul>
<li><a href="#配置grid用户的环境变量">配置grid用户的环境变量</a></li>
<li><a href="#配置oracle的环境变量">配置oracle的环境变量</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#配置网络">配置网络</a><ul>
<li><a href="#配置hosts解析">配置hosts解析</a></li>
<li><a href="#关闭虚拟网卡">关闭虚拟网卡</a></li>
<li><a href="#禁用zeroconf">禁用ZEROCONF</a></li>
</ul>
</li>
<li><a href="#配置ssh互信">配置SSH互信</a></li>
<li><a href="#配置存储">配置存储</a><ul>
<li><a href="#安装asmlib">安装ASMLIB</a></li>
<li><a href="#创建分区">创建分区</a></li>
<li><a href="#创建磁盘组">创建磁盘组</a></li>
</ul>
</li>
</ul>
<!-- tocstop -->
<h3 id="配置操作系统"><a href="#u914D_u7F6E_u64CD_u4F5C_u7CFB_u7EDF" class="headerlink" title="配置操作系统"></a>配置操作系统</h3><h4 id="安装依赖包"><a href="#u5B89_u88C5_u4F9D_u8D56_u5305" class="headerlink" title="安装依赖包"></a>安装依赖包</h4><p>node01和node02上分别执行<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yum -y install binutils compat-libcap1 compat-libstdc++ compat-libstdc++ e2fsprogs e2fsprogs-libs glibc glibc glibc-devel glibc-devel ksh libgcc libgcc libstdc++ libstdc++ libstdc++-devel libstdc++-devel libaio libaio libaio-devel libaio-devel libXtst libXtst libX11 libX11 libXau libXau libxcb libxcb libXi libXi make net-tools nfs-utils sysstat smartmontools</div></pre></td></tr></table></figure></p>
<h4 id="配置内核参数"><a href="#u914D_u7F6E_u5185_u6838_u53C2_u6570" class="headerlink" title="配置内核参数"></a>配置内核参数</h4><p>node01和node02上分别执行<br>编辑/etc/sysctl.conf文件<br><code>vi /etc/sysctl.conf</code><br>添加或修改<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">kernel<span class="selector-class">.shmall</span> = <span class="number">2097152</span></div><div class="line">kernel<span class="selector-class">.shmmax</span> = <span class="number">4294967295</span></div><div class="line">fs<span class="selector-class">.aio-max-nr</span> = <span class="number">1048576</span></div><div class="line">fs<span class="selector-class">.file-max</span> = <span class="number">6815744</span></div><div class="line">kernel<span class="selector-class">.shmmni</span> = <span class="number">4096</span></div><div class="line">kernel<span class="selector-class">.sem</span> = <span class="number">250</span> <span class="number">32000</span> <span class="number">100</span> <span class="number">128</span></div><div class="line">net<span class="selector-class">.ipv4</span><span class="selector-class">.ip_local_port_range</span> = <span class="number">9000</span> <span class="number">65500</span></div><div class="line">net<span class="selector-class">.core</span><span class="selector-class">.rmem_default</span> = <span class="number">262144</span></div><div class="line">net<span class="selector-class">.core</span><span class="selector-class">.rmem_max</span> = <span class="number">4194304</span></div><div class="line">net<span class="selector-class">.core</span><span class="selector-class">.wmem_default</span> = <span class="number">262144</span></div><div class="line">net<span class="selector-class">.core</span><span class="selector-class">.wmem_max</span> = <span class="number">1048576</span></div><div class="line">kernel.panic_on_oops=<span class="number">1</span></div></pre></td></tr></table></figure></p>
<p>执行<code>sysctl -p</code>使其生效</p>
<h4 id="关闭ntp"><a href="#u5173_u95EDNTP" class="headerlink" title="关闭NTP"></a>关闭NTP</h4><p>安装Oracle RAC要求各节点间时间同步，本文选用Oracle Cluster Time Synchronization Service进行同步，因而关闭NTP服务。<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">/sbin<span class="built_in">/service </span>ntpd stop</div><div class="line">chkconfig ntpd off</div><div class="line">mv /etc/ntp.conf /etc/ntp.conf.org</div><div class="line">rm /var/run/ntpd.pid</div></pre></td></tr></table></figure></p>
<h4 id="配置pam"><a href="#u914D_u7F6EPAM" class="headerlink" title="配置PAM"></a>配置PAM</h4><p>编辑/etc/pam.d/login文件<br><code>vi /etc/pam.d/login</code><br>添加<br><code>session required pam_limits.so</code><br>编辑/etc/security/limits.conf文件<br><code>vi /etc/security/limits.conf</code><br>添加<br><figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="variable">@oinstall</span> hard nofile <span class="number">65536</span></div><div class="line"><span class="variable">@oinstall</span> soft nofile <span class="number">10240</span></div><div class="line"><span class="variable">@oinstall</span> hard nproc <span class="number">16384</span></div><div class="line"><span class="variable">@oinstall</span> soft nproc <span class="number">16384</span></div><div class="line"><span class="variable">@oinstall</span> hard stack <span class="number">32768</span></div><div class="line"><span class="variable">@oinstall</span> soft stack <span class="number">10240</span></div><div class="line"><span class="variable">@oinstall</span> soft memlock <span class="number">475188563</span></div><div class="line"><span class="variable">@oinstall</span> hard memlock <span class="number">475188563</span></div></pre></td></tr></table></figure></p>
<h4 id="关闭selinux"><a href="#u5173_u95EDSELinux" class="headerlink" title="关闭SELinux"></a>关闭SELinux</h4><p>node01和node02上分别执行<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">setenforce <span class="number">0</span></div><div class="line">vi <span class="regexp">/etc/</span>sysconfig<span class="regexp">/selinux</span></div></pre></td></tr></table></figure></p>
<p>修改为<br><code>SELINUX=disabled</code></p>
<h4 id="创建用户-组-文件夹"><a href="#u521B_u5EFA_u7528_u6237_u3001_u7EC4_u3001_u6587_u4EF6_u5939" class="headerlink" title="创建用户、组、文件夹"></a>创建用户、组、文件夹</h4><p>node01和node02上分别执行<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">groupadd -g <span class="number">1000</span> oinstall</div><div class="line">groupadd -g <span class="number">1020</span> asmadmin</div><div class="line">groupadd -g <span class="number">1021</span> asmdba</div><div class="line">groupadd -g <span class="number">1022</span> asmoper</div><div class="line">groupadd -g <span class="number">1031</span> dba</div><div class="line">groupadd -g <span class="number">1032</span> oper</div><div class="line">useradd -u <span class="number">1100</span> -g oinstall -G asmadmin,asmdba,asmoper,oper,dba grid</div><div class="line">useradd -u <span class="number">1101</span> -g oinstall -G dba,asmdba,oper oracle</div><div class="line">mkdir -p <span class="regexp">/u01/</span>software</div><div class="line">mkdir -p <span class="regexp">/u01/</span>app<span class="regexp">/12.1.0/</span>grid</div><div class="line">mkdir -p <span class="regexp">/u01/</span>app/grid</div><div class="line">mkdir -p <span class="regexp">/u01/</span>app/oracle</div><div class="line">chown -R <span class="string">grid:</span>oinstall /u01</div><div class="line">chown <span class="string">oracle:</span>oinstall <span class="regexp">/u01/</span>app/oracle</div><div class="line">chmod -R <span class="number">775</span> <span class="regexp">/u01/</span></div></pre></td></tr></table></figure></p>
<p>将下面的两个文件上传至node01的/u01/software文件夹下<br>linuxx64_12201_grid_home.zip<br>linuxx64_12201_database.zip<br>将所有者更改为grid,权限更改为775<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">chown grid:oinstall linuxx64_12201_database<span class="selector-class">.zip</span> linuxx64_12201_grid_home<span class="selector-class">.zip</span></div><div class="line">chmod <span class="number">775</span> linuxx64_12201_database<span class="selector-class">.zip</span> linuxx64_12201_grid_home.zip</div></pre></td></tr></table></figure></p>
<h4 id="配置环境变量"><a href="#u914D_u7F6E_u73AF_u5883_u53D8_u91CF" class="headerlink" title="配置环境变量"></a>配置环境变量</h4><h5 id="配置grid用户的环境变量"><a href="#u914D_u7F6Egrid_u7528_u6237_u7684_u73AF_u5883_u53D8_u91CF" class="headerlink" title="配置grid用户的环境变量"></a>配置grid用户的环境变量</h5><p>node01上执行<br>编辑／home/gird/.bash_profile文件<br><code>vi ／home/gird/.bash_profile</code><br>添加<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="builtin-name">export</span> <span class="attribute">ORACLE_SID</span>=+ASM1</div><div class="line"><span class="builtin-name">export</span> <span class="attribute">TMP</span>=/tmp</div><div class="line"><span class="builtin-name">export</span> <span class="attribute">ORACLE_BASE</span>=/u01/app/grid</div><div class="line"><span class="builtin-name">export</span> <span class="attribute">ORACLE_HOME</span>=/u01/app/12.2.0/grid</div><div class="line"><span class="builtin-name">export</span> <span class="attribute">PATH</span>=<span class="variable">$ORACLE_HOME</span>/bin:/usr/sbin:$PATH</div><div class="line"><span class="builtin-name">export</span> <span class="attribute">LD_LIBRARY_PATH</span>=<span class="variable">$ORACLE_HOME</span>/lib:/lib:/usr/lib</div><div class="line"><span class="builtin-name">export</span> <span class="attribute">CLASSPATH</span>=<span class="variable">$ORACLE_HOME</span>/JRE:$ORACLE_HOME/jlib:$ORACLE_HOME/rdbms/jlib</div><div class="line"><span class="builtin-name">export</span> <span class="attribute">LC_ALL</span>=en_US.UTF-8</div></pre></td></tr></table></figure></p>
<p>node02上执行<br>编辑／home/gird/.bash_profile文件<br><code>vi ／home/gird/.bash_profile</code><br>添加<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="builtin-name">export</span> <span class="attribute">ORACLE_SID</span>=+ASM2</div><div class="line"><span class="builtin-name">export</span> <span class="attribute">TMP</span>=/tmp</div><div class="line"><span class="builtin-name">export</span> <span class="attribute">ORACLE_BASE</span>=/u01/app/grid</div><div class="line"><span class="builtin-name">export</span> <span class="attribute">ORACLE_HOME</span>=/u01/app/12.2.0/grid</div><div class="line"><span class="builtin-name">export</span> <span class="attribute">PATH</span>=<span class="variable">$ORACLE_HOME</span>/bin:/usr/sbin:$PATH</div><div class="line"><span class="builtin-name">export</span> <span class="attribute">LD_LIBRARY_PATH</span>=<span class="variable">$ORACLE_HOME</span>/lib:/lib:/usr/lib</div><div class="line"><span class="builtin-name">export</span> <span class="attribute">CLASSPATH</span>=<span class="variable">$ORACLE_HOME</span>/JRE:$ORACLE_HOME/jlib:$ORACLE_HOME/rdbms/jlib</div><div class="line"><span class="builtin-name">export</span> <span class="attribute">LC_ALL</span>=en_US.UTF-8</div></pre></td></tr></table></figure></p>
<h5 id="配置oracle的环境变量"><a href="#u914D_u7F6Eoracle_u7684_u73AF_u5883_u53D8_u91CF" class="headerlink" title="配置oracle的环境变量"></a>配置oracle的环境变量</h5><p>node01和node02上分别执行<br>编辑/home/oracle/.bash_profile文件<br><code>vi /home/oracle/.bash_profile</code><br>添加<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="builtin-name">export</span> <span class="attribute">TMP</span>=/tmp</div><div class="line"><span class="builtin-name">export</span> <span class="attribute">ORACLE_BASE</span>=/u01/app/oracle</div><div class="line"><span class="builtin-name">export</span> <span class="attribute">ORACLE_HOME</span>=<span class="variable">$ORACLE_BASE</span>/product/12.2.0/dbhome_1</div><div class="line"><span class="builtin-name">export</span> <span class="attribute">PATH</span>=<span class="variable">$ORACLE_HOME</span>/bin:/usr/sbin:$ORACLE_HOME/OPatch:$PATH</div><div class="line"><span class="builtin-name">export</span> <span class="attribute">LD_LIBRARY_PATH</span>=<span class="variable">$ORACLE_HOME</span>/lib:/lib:/usr/lib</div><div class="line"><span class="builtin-name">export</span> <span class="attribute">CLASSPATH</span>=<span class="variable">$ORACLE_HOME</span>/JRE:$ORACLE_HOME/jlib:$ORACLE_HOME/rdbms/jlib</div><div class="line"><span class="builtin-name">export</span> <span class="attribute">NLS_LANG</span>=AMERICAN_AMERICA.UTF8</div><div class="line"><span class="builtin-name">export</span> <span class="attribute">LC_ALL</span>=en_US.UTF-8</div></pre></td></tr></table></figure></p>
<h3 id="配置网络"><a href="#u914D_u7F6E_u7F51_u7EDC" class="headerlink" title="配置网络"></a>配置网络</h3><h4 id="配置hosts解析"><a href="#u914D_u7F6Ehosts_u89E3_u6790" class="headerlink" title="配置hosts解析"></a>配置hosts解析</h4><p>如<a href="../../23/Oracle-RAC-12cR2安装手册-1-虚拟机的准备/#配置第一台虚拟机">Oracle RAC安装手册(1)虚拟机的准备</a>中所述，Oracle RAC的安装至少需要两块网卡。前文已完成网卡的添加和IP的配置，此处介绍IP的规划。</p>
<table class="table table-striped">
<thead>
<tr>
<th style="text-align:center">Name</th>
<th style="text-align:center">node01</th>
<th style="text-align:center">node02</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Public IP</td>
<td style="text-align:center">172.16.10.11</td>
<td style="text-align:center">172.16.10.12</td>
</tr>
<tr>
<td style="text-align:center">Private IP</td>
<td style="text-align:center">192.168.10.11</td>
<td style="text-align:center">192.168.10.12</td>
</tr>
<tr>
<td style="text-align:center">Virtual IP</td>
<td style="text-align:center">172.16.10.21</td>
<td style="text-align:center">172.16.10.22</td>
</tr>
<tr>
<td style="text-align:center">SCAN IP</td>
<td style="text-align:center">172.16.10.31</td>
<td style="text-align:center">172.16.10.32</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">172.16.10.33</td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>

<blockquote>
<p>注：</p>
<ol>
<li>Public IP, Virtual IP, SCAN IP必须在同一个子网下；</li>
<li>SCAN IP推荐配置三个，最少一个。</li>
</ol>
</blockquote>
<p>node01和node02上分别执行<br>编辑/etc/hosts文件<br><code>vi /etc/hosts</code><br>添加<br><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"># <span class="selector-tag">Public</span></div><div class="line">172<span class="selector-class">.16</span><span class="selector-class">.10</span><span class="selector-class">.11</span> <span class="selector-tag">node01</span><span class="selector-class">.myCluster</span><span class="selector-class">.com</span> <span class="selector-tag">node01</span></div><div class="line">172<span class="selector-class">.16</span><span class="selector-class">.10</span><span class="selector-class">.12</span> <span class="selector-tag">node02</span><span class="selector-class">.myCluster</span><span class="selector-class">.com</span> <span class="selector-tag">node02</span></div><div class="line"># <span class="selector-tag">Private</span></div><div class="line">192<span class="selector-class">.168</span><span class="selector-class">.10</span><span class="selector-class">.11</span>   <span class="selector-tag">node01-priv</span><span class="selector-class">.myCluster</span><span class="selector-class">.com</span>   <span class="selector-tag">node01-priv</span></div><div class="line">192<span class="selector-class">.168</span><span class="selector-class">.10</span><span class="selector-class">.12</span>   <span class="selector-tag">node02-priv</span><span class="selector-class">.myCluster</span><span class="selector-class">.com</span>   <span class="selector-tag">node02-priv</span></div><div class="line"># <span class="selector-tag">Virtual</span></div><div class="line">172<span class="selector-class">.16</span><span class="selector-class">.10</span><span class="selector-class">.21</span>   <span class="selector-tag">node01-vip</span><span class="selector-class">.myCluster</span><span class="selector-class">.com</span>    <span class="selector-tag">node01-vip</span></div><div class="line">172<span class="selector-class">.16</span><span class="selector-class">.10</span><span class="selector-class">.22</span>   <span class="selector-tag">node02-vip</span><span class="selector-class">.myCluster</span><span class="selector-class">.com</span>    <span class="selector-tag">node02-vip</span></div><div class="line"># <span class="selector-tag">SCAN</span></div><div class="line">172<span class="selector-class">.16</span><span class="selector-class">.10</span><span class="selector-class">.31</span>   <span class="selector-tag">nodes-scan</span><span class="selector-class">.myCluster</span><span class="selector-class">.com</span> <span class="selector-tag">nodes-scan</span></div><div class="line">172<span class="selector-class">.16</span><span class="selector-class">.10</span><span class="selector-class">.32</span>   <span class="selector-tag">nodes-scan</span><span class="selector-class">.myCluster</span><span class="selector-class">.com</span> <span class="selector-tag">nodes-scan</span></div><div class="line">172<span class="selector-class">.16</span><span class="selector-class">.10</span><span class="selector-class">.33</span>   <span class="selector-tag">nodes-scan</span><span class="selector-class">.myCluster</span><span class="selector-class">.com</span> <span class="selector-tag">nodes-scan</span></div></pre></td></tr></table></figure></p>
<h4 id="关闭虚拟网卡"><a href="#u5173_u95ED_u865A_u62DF_u7F51_u5361" class="headerlink" title="关闭虚拟网卡"></a>关闭虚拟网卡</h4><p>如果安装了libvirt，需要关闭虚拟网卡功能。<br>node01和node02分别执行<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">virsh net-list</div><div class="line">virsh net-destroy<span class="built_in"> default</span></div><div class="line">virsh net-undefine<span class="built_in"> default</span></div><div class="line">service libvirtd restart</div></pre></td></tr></table></figure></p>
<h4 id="禁用zeroconf"><a href="#u7981_u7528ZEROCONF" class="headerlink" title="禁用ZEROCONF"></a>禁用ZEROCONF</h4><p>node01和node02分别执行<br>编辑/etc/sysconfig/network文件<br><code>vi /etc/sysconfig/network</code><br>添加<br><figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attr">NOZEROCONF</span>=<span class="literal">yes</span></div></pre></td></tr></table></figure></p>
<h3 id="配置ssh互信"><a href="#u914D_u7F6ESSH_u4E92_u4FE1" class="headerlink" title="配置SSH互信"></a>配置SSH互信</h3><p>使用grid用户登录node01或切换到grid用户，解压linuxx64_12201_grid_home.zip，分别为grid用户和oracle用户配置SSH互信。</p>
<blockquote>
<p>注：<br>配置过程中，需要输入oracle和grid的密码，可提前为其设置密码。</p>
</blockquote>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">unzip linuxx64_12201_grid_home.zip -d grid</div><div class="line">cd grid/oui/prov/resources/scripts/</div><div class="line">./sshUserSetup.sh -hosts <span class="string">"node01 node02"</span> -<span class="keyword">user</span> <span class="title">grid</span>  -advanced -noPromptPassphrase</div><div class="line">./sshUserSetup.sh -hosts <span class="string">"node01 node02"</span> -<span class="keyword">user</span> <span class="title">oracle</span>  -advanced -noPromptPassphrase</div></pre></td></tr></table></figure>
<p>使用grid用户登录node01验证<br><figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ssh node02 <span class="built_in">date</span></div><div class="line">ssh node02-priv <span class="built_in">date</span></div></pre></td></tr></table></figure></p>
<p>使用grid用户登录node02验证<br><figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ssh node01 <span class="built_in">date</span></div><div class="line">ssh node01-priv <span class="built_in">date</span></div></pre></td></tr></table></figure></p>
<p>使用oracle用户登录node01验证<br><figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ssh node02 <span class="built_in">date</span></div><div class="line">ssh node02-priv <span class="built_in">date</span></div></pre></td></tr></table></figure></p>
<p>使用oracle用户登录node02验证<br><figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ssh node01 <span class="built_in">date</span></div><div class="line">ssh node01-priv <span class="built_in">date</span></div></pre></td></tr></table></figure></p>
<h3 id="配置存储"><a href="#u914D_u7F6E_u5B58_u50A8" class="headerlink" title="配置存储"></a>配置存储</h3><p>本文选用ASM作为共享存储，前文<a href="../../23/Oracle-RAC-12cR2安装手册-1-虚拟机的准备/#添加共享磁盘">Oracle RAC安装手册(1)虚拟机的准备</a>中已添加共享磁盘，接下来介绍如何配置ASM。</p>
<blockquote>
<p>注：</p>
<ol>
<li>本文使用的磁盘为/dev/sdb，OCR磁盘组的冗余类型为Normal，DATA磁盘组的冗余类型为External。/dev/sdb共13G空间，创建3个1G分区给OCR磁盘组使用，剩余10G分配至DATA磁盘组。</li>
<li>本文仅演示安装过程，关于ASM磁盘的大小<a href="https://docs.oracle.com/database/122/CWLIN/oracle-clusterware-storage-space-requirements.htm#CWLIN-GUID-97FD5D40-A65B-4575-AD12-06C491AF3F41" target="_blank" rel="external">官方文档</a>有具体的最小限制，实际生产中请注意。</li>
</ol>
</blockquote>
<h4 id="安装asmlib"><a href="#u5B89_u88C5ASMLIB" class="headerlink" title="安装ASMLIB"></a>安装ASMLIB</h4><p>参考<a href="../../../07/04/Oracle-Linux下安装ASMLIB/">Oracle Linux下安装ASMLIB</a>,分别在node01和node02安装ASMLIB,并配置、启动oracleasm服务。</p>
<h4 id="创建分区"><a href="#u521B_u5EFA_u5206_u533A" class="headerlink" title="创建分区"></a>创建分区</h4><p>在node01上执行<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">fdisk <span class="regexp">/dev/</span>sdb</div></pre></td></tr></table></figure></p>
<p>创建过程参考如下：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div></pre></td><td class="code"><pre><div class="line">Device contains neither a valid DOS partition table, nor Sun, SGI or OSF disklabel</div><div class="line">Building a new DOS disklabel with disk identifier 0x8a3d3388.</div><div class="line">Changes will remain in memory only, until you decide to write them.</div><div class="line">After that, of course, the previous content won't be recoverable.</div><div class="line">Warning: invalid flag 0x0000 of partition table 4 will be corrected by w(rite)</div><div class="line">WARNING: DOS-compatible mode is deprecated. It's strongly recommended to</div><div class="line">         switch off the mode (command 'c') and <span class="keyword">change</span> display units <span class="keyword">to</span></div><div class="line">         sectors (command <span class="string">'u'</span>).</div><div class="line">Command (m <span class="keyword">for</span> <span class="keyword">help</span>): n</div><div class="line">Command <span class="keyword">action</span></div><div class="line">   e   <span class="keyword">extended</span></div><div class="line">   p   primary <span class="keyword">partition</span> (<span class="number">1</span><span class="number">-4</span>)</div><div class="line">e</div><div class="line"><span class="keyword">Partition</span> <span class="built_in">number</span> (<span class="number">1</span><span class="number">-4</span>): <span class="number">1</span></div><div class="line"><span class="keyword">First</span> cylinder (<span class="number">1</span><span class="number">-1697</span>, <span class="keyword">default</span> <span class="number">1</span>):</div><div class="line"><span class="keyword">Using</span> <span class="keyword">default</span> <span class="keyword">value</span> <span class="number">1</span></div><div class="line"><span class="keyword">Last</span> cylinder, +cylinders <span class="keyword">or</span> +<span class="keyword">size</span>&#123;K,M,G&#125; (<span class="number">1</span><span class="number">-1697</span>, <span class="keyword">default</span> <span class="number">1697</span>): +<span class="number">1</span>G</div><div class="line">Command (m <span class="keyword">for</span> <span class="keyword">help</span>): n</div><div class="line">Command <span class="keyword">action</span></div><div class="line">   l   <span class="keyword">logical</span> (<span class="number">5</span> <span class="keyword">or</span> <span class="keyword">over</span>)</div><div class="line">   p   primary <span class="keyword">partition</span> (<span class="number">1</span><span class="number">-4</span>)</div><div class="line">[root@node01 ~]# fdisk /dev/sdb</div><div class="line">Device contains neither a valid DOS <span class="keyword">partition</span> <span class="keyword">table</span>, nor Sun, SGI <span class="keyword">or</span> OSF disklabel</div><div class="line">Building a <span class="keyword">new</span> DOS disklabel <span class="keyword">with</span> disk identifier <span class="number">0x18c3ca52</span>.</div><div class="line">Changes will remain <span class="keyword">in</span> <span class="keyword">memory</span> <span class="keyword">only</span>, <span class="keyword">until</span> you decide <span class="keyword">to</span> write them.</div><div class="line"><span class="keyword">After</span> that, <span class="keyword">of</span> course, the previous <span class="keyword">content</span> won<span class="string">'t be recoverable.</span></div><div class="line">Warning: invalid flag 0x0000 of partition table 4 will be corrected by w(rite)</div><div class="line">WARNING: DOS-compatible mode is deprecated. It's strongly recommended <span class="keyword">to</span></div><div class="line">         <span class="keyword">switch</span> <span class="keyword">off</span> the <span class="keyword">mode</span> (command <span class="string">'c'</span>) <span class="keyword">and</span> <span class="keyword">change</span> display units <span class="keyword">to</span></div><div class="line">         sectors (command <span class="string">'u'</span>).</div><div class="line">Command (m <span class="keyword">for</span> <span class="keyword">help</span>): n</div><div class="line">Command <span class="keyword">action</span></div><div class="line">   e   <span class="keyword">extended</span></div><div class="line">   p   primary <span class="keyword">partition</span> (<span class="number">1</span><span class="number">-4</span>)</div><div class="line">p</div><div class="line"><span class="keyword">Partition</span> <span class="built_in">number</span> (<span class="number">1</span><span class="number">-4</span>): <span class="number">1</span></div><div class="line"><span class="keyword">First</span> cylinder (<span class="number">1</span><span class="number">-1697</span>, <span class="keyword">default</span> <span class="number">1</span>):</div><div class="line"><span class="keyword">Using</span> <span class="keyword">default</span> <span class="keyword">value</span> <span class="number">1</span></div><div class="line"><span class="keyword">Last</span> cylinder, +cylinders <span class="keyword">or</span> +<span class="keyword">size</span>&#123;K,M,G&#125; (<span class="number">1</span><span class="number">-1697</span>, <span class="keyword">default</span> <span class="number">1697</span>): +<span class="number">1</span>G</div><div class="line">Command (m <span class="keyword">for</span> <span class="keyword">help</span>): n</div><div class="line">Command <span class="keyword">action</span></div><div class="line">   e   <span class="keyword">extended</span></div><div class="line">   p   primary <span class="keyword">partition</span> (<span class="number">1</span><span class="number">-4</span>)</div><div class="line">p</div><div class="line"><span class="keyword">Partition</span> <span class="built_in">number</span> (<span class="number">1</span><span class="number">-4</span>): <span class="number">2</span></div><div class="line"><span class="keyword">First</span> cylinder (<span class="number">133</span><span class="number">-1697</span>, <span class="keyword">default</span> <span class="number">133</span>):</div><div class="line"><span class="keyword">Using</span> <span class="keyword">default</span> <span class="keyword">value</span> <span class="number">133</span></div><div class="line"><span class="keyword">Last</span> cylinder, +cylinders <span class="keyword">or</span> +<span class="keyword">size</span>&#123;K,M,G&#125; (<span class="number">133</span><span class="number">-1697</span>, <span class="keyword">default</span> <span class="number">1697</span>): +<span class="number">1</span>G</div><div class="line">Command (m <span class="keyword">for</span> <span class="keyword">help</span>): n</div><div class="line">Command <span class="keyword">action</span></div><div class="line">   e   <span class="keyword">extended</span></div><div class="line">   p   primary <span class="keyword">partition</span> (<span class="number">1</span><span class="number">-4</span>)</div><div class="line">p</div><div class="line"><span class="keyword">Partition</span> <span class="built_in">number</span> (<span class="number">1</span><span class="number">-4</span>): <span class="number">3</span></div><div class="line"><span class="keyword">First</span> cylinder (<span class="number">265</span><span class="number">-1697</span>, <span class="keyword">default</span> <span class="number">265</span>):</div><div class="line"><span class="keyword">Using</span> <span class="keyword">default</span> <span class="keyword">value</span> <span class="number">265</span></div><div class="line"><span class="keyword">Last</span> cylinder, +cylinders <span class="keyword">or</span> +<span class="keyword">size</span>&#123;K,M,G&#125; (<span class="number">265</span><span class="number">-1697</span>, <span class="keyword">default</span> <span class="number">1697</span>): +<span class="number">1</span>G</div><div class="line">Command (m <span class="keyword">for</span> <span class="keyword">help</span>): n</div><div class="line">Command <span class="keyword">action</span></div><div class="line">   e   <span class="keyword">extended</span></div><div class="line">   p   primary <span class="keyword">partition</span> (<span class="number">1</span><span class="number">-4</span>)</div><div class="line">p</div><div class="line">Selected <span class="keyword">partition</span> <span class="number">4</span></div><div class="line"><span class="keyword">First</span> cylinder (<span class="number">397</span><span class="number">-1697</span>, <span class="keyword">default</span> <span class="number">397</span>):</div><div class="line"><span class="keyword">Using</span> <span class="keyword">default</span> <span class="keyword">value</span> <span class="number">397</span></div><div class="line"><span class="keyword">Last</span> cylinder, +cylinders <span class="keyword">or</span> +<span class="keyword">size</span>&#123;K,M,G&#125; (<span class="number">397</span><span class="number">-1697</span>, <span class="keyword">default</span> <span class="number">1697</span>):</div><div class="line"><span class="keyword">Using</span> <span class="keyword">default</span> <span class="keyword">value</span> <span class="number">1697</span></div><div class="line">Command (m <span class="keyword">for</span> <span class="keyword">help</span>): w</div><div class="line">The <span class="keyword">partition</span> <span class="keyword">table</span> has been altered!</div><div class="line"><span class="keyword">Calling</span> ioctl() <span class="keyword">to</span> re-<span class="keyword">read</span> <span class="keyword">partition</span> table.</div><div class="line">Syncing disks.</div></pre></td></tr></table></figure></p>
<blockquote>
<p>注：<br>仅创建分区即可，无需格式化。</p>
</blockquote>
<p>创建完成后，磁盘分区情况如下：<br><img src="/2017/06/29/Oracle-RAC-12cR2安装手册-2-环境的准备/nodes-storage-configure-0.png" alt="nodes-storage-configure" title="nodes-storage-configure"></p>
<h4 id="创建磁盘组"><a href="#u521B_u5EFA_u78C1_u76D8_u7EC4" class="headerlink" title="创建磁盘组"></a>创建磁盘组</h4><p>node01执行如下命令创建磁盘组<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">oracleasm createdisk OCR01 <span class="regexp">/dev/</span>sdb1</div><div class="line">oracleasm createdisk OCR02 <span class="regexp">/dev/</span>sdb2</div><div class="line">oracleasm createdisk OCR03 <span class="regexp">/dev/</span>sdb3</div></pre></td></tr></table></figure></p>
<p>创建过程参考如下</p>
<img src="/2017/06/29/Oracle-RAC-12cR2安装手册-2-环境的准备/nodes-storage-configure-1.png" alt="nodes-storage-configure" title="nodes-storage-configure">
<p>使用<code>oracleasm listdisks</code>查看已创建的磁盘组</p>
<img src="/2017/06/29/Oracle-RAC-12cR2安装手册-2-环境的准备/nodes-storage-configure-3.png" alt="nodes-storage-configure" title="nodes-storage-configure">
<p>创建成功👆🏻<br>node02执行如下命令扫描node01上已创建的磁盘组<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">oracleasm scandisks</span></div></pre></td></tr></table></figure></p>
<p>扫描过程参考如下</p>
<img src="/2017/06/29/Oracle-RAC-12cR2安装手册-2-环境的准备/nodes-storage-configure-2.png" alt="nodes-storage-configure" title="nodes-storage-configure">
<p>使用<code>oracleasm listdisks</code>查看扫描到的磁盘组</p>
<img src="/2017/06/29/Oracle-RAC-12cR2安装手册-2-环境的准备/nodes-storage-configure-4.png" alt="nodes-storage-configure" title="nodes-storage-configure">
<p>扫描成功👆🏻<br>自此完成了环境的准备工作。</p>


  </article>
  </script>
    <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
  </script>
  <div class="busuanzi center">
    PV:&nbsp;<span id="busuanzi_value_page_pv"></span>&nbsp;・&nbsp;
    VV:&nbsp;<span id="busuanzi_value_site_pv"></span>&nbsp;・&nbsp;
    UV:&nbsp;<span id="busuanzi_value_site_uv"></span>
  </div>


<div id="disqus_thread"></div>
<script>

var disqus_config = function () {
this.page.url = 'https://JayceLau.github.io/2017/06/29/Oracle-RAC-12cR2安装手册-2-环境的准备/index.html';
this.page.identifier = undefined;
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');

s.src = '//JR4ever.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>



    </div>
  </div>
  <footer class="page-footer"><div class="clearfix">
</div>
<div class="right-foot container">
    <div class="firstrow">
        <a href="#top" target="_self">
        <i class="fa fa-arrow-right"></i>
        </a>
        © JR 2010-4ever
    </div>
    <div class="secondrow">
        <a href="">
        
        </a>
    </div>
</div>
<div class="clearfix">
</div>
</footer>
  <script src="//cdn.bootcss.com/jquery/2.2.1/jquery.min.js"></script>
<script src="/js/search.js"></script>
<script type="text/javascript">

// disqus scripts


// dropdown scripts
$(".dropdown").click(function(event) {
  var current = $(this);
  event.stopPropagation();
  $(current).children(".dropdown-content")[($(current).children(".dropdown-content").hasClass("open"))?'removeClass':'addClass']("open")
});
$(document).click(function(){
    $(".dropdown-content").removeClass("open");
})

var path = "/search.xml";
searchFunc(path, 'local-search-input', 'local-search-result');

</script>

</body>
</html>
